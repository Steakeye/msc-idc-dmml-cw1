---
title: "WhiteWine"
output: html_document
---


```{r setup, include=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, echo=FALSE, include=FALSE, message=FALSE}
mirrorUrl = "http://cran.ma.imperial.ac.uk"

# Install and load all packages up-front!
if(!require(readxl)) install.packages("readxl", repos = mirrorUrl)
if(!require(cluster)) install.packages("cluster", repos = mirrorUrl)
if(!require(NbClust)) install.packages("NbClust", repos = mirrorUrl)
if(!require(fpc)) install.packages("fpc", repos = mirrorUrl, dependencies = TRUE)
if(!require(flexclust)) install.packages("flexclust", repos = mirrorUrl, dependencies = TRUE)
#
library("readxl")
library("fpc")
library("flexclust")
```

<section>

#Question 2: White Wine clustering (Hierarchical)

##Starting off

>You need to conduct the hierarchical clustering (agglomerative) clustering analysis of the white wine sheet. Investigate the hclust() function for single, complete, average methods. Create the visualization of all methods using a dendrogram. Look at the cophenetic correlation between each clustering result using cor.dendlist. Discuss the produced results after using the coorplot function. Write a code in R Studio to address all the above
issues.

...


<!--
2nd Objective (hierarchical clustering)
• Perform hierarchical clustering (for single, complete, etc) 15
• Create a dendrogram 5
• Check the cophenetic correlation and discuss your findings 3
• Coorplot function and discuss your findings 2

resources:
https://drive.google.com/file/d/0B-1zDxRmAKmjeTFzM182Szd3WDQ/view
https://drive.google.com/drive/folders/0B-1zDxRmAKmjdFYxcEVFaFZZcE0
-->

Firstly we need to load the data...

```{r}
#going to import the Excel spreadsheet WhiteWine dataset
wine.raw <- read_excel("../data/Whitewine.xlsx")
```

Here's a glance at the datset

```{r}
head(wine.raw)
str(wine.raw)
```

We want to scale the data to allow all attributes to be compared more easily. First of all let's split our data so we have two tables, one with all the attributes of wine and the other just with the humanly perceived quality. 

```{r}
wine.all_but_q <- wine.raw[1:11]
wine.q <- wine.raw$quality

#Wine properties
str(wine.all_but_q)

#Wine quality values
str(wine.q)
```

Now we scale the data
```{r}
wine.scaled <- as.data.frame(scale(wine.all_but_q))

#Summary of scaled wine data
summary(wine.scaled)
```

```{r}
boxplot(wine.scaled, main="Looking at the data graphically", xlab="Wine Attributes", ylab="Scalled values") 
```

We can see from these box-plots that some attributes seem to have some clear outliers that would suggest erroneous data and not just natural extremes. As such, we can decide that it's worth cleansing the data a little by removing these outliers from the dataset. For example, Alcohol on the most right column seesms to have very clear boundaries as we'd expect from wine; when that is compared with some other attributes, they seem to tell a different story: Chlorides seems to have a lot of values that are in the upper quartile, and a large distance etween min and max values but when you look it you can see there's a gradient that suggests a normal distribution; in contrast to this, the columns Residual Sugar, Free Sulfur Dioxide and Density all seem to not only have relatively large min and max distances but there seem to be uppermost values that with nearest neighbour values that are a relatively large distance away.

## Conclusion

...

</section>
