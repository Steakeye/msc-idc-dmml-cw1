---
title: "WhiteWine"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
# Install and load all packages up-front!
#pkgs <- c("cluster",  "NbClust")
mirrorUrl = "http://cran.ma.imperial.ac.uk"

# read xl
if(!require(readxl)) install.packages("readxl",repos = mirrorUrl)
if(!require(cluster)) install.packages("cluster",repos = mirrorUrl)
if(!require(NbClust)) install.packages("NbClust",repos = mirrorUrl)
#install.packages("readxl")
library("readxl")

#install.packages(pkgs)
#library(NbClust)
#getwd()
#myWD = "C:/Users/Lenovo/Documents/R/R-Markdown"
#setwd(myWD)
#knitr::opts_knit$set(root.dir = myWD)
#getwd()

```
#Question 1: White Wine clustering

##Starting off

Firstly we need to load the data...
```{r}
#going to import the Excel spreadsheet WhiteWine dataset
# xlsx files
wine.raw <- read_excel("../data/Whitewine.xlsx")
head(wine.raw)
```

Here's a a glance at the datset
```{r}
str(wine.raw)

#Normalise the WhiteWine dataset from Excel import

#data.train <- scale(my_data[-1])
#summary(data.train)
#nc <- NbClust(data.train,
#min.nc=2, max.nc=15,
#method="kmeans") #runtime hangs at this point - needs optimising
#barplot(table(nc$Best.n[1,]),
#xlab="Numer of Clusters",
#ylab="Number of Criteria",
#main="Number of Clusters Chosen by 26 Criteria")
```

We want to scale the data to allow all attributes to be compared more easily. First of all let's split our data so we have two tables, one with all the attributes of wine and the other just with the humanly percieved quality 
```{r}
wine.all_but_q <- wine.raw[1:11]
wine.q <- wine.raw$quality

str(wine.all_but_q)
str(wine.q)
#wine.scaled <- scale(wine.raw)
```

Now we scale the data
```{r}
wine.scaled <- scale(wine.all_but_q)

summary(wine.scaled)
```

```{r}
boxplot(wine.scaled, main="Looking at the data graphically") 
```


## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
